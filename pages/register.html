<!DOCTYPE html>
<html lang="hr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Registracija | Fast Food</title>
  <link rel="stylesheet" href="../css/registration_style.css">
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const form = document.querySelector(".registration-form");
      const messageBox = document.getElementById("message-box");

      // Provjera je li korisnik već registriran i omogućavanje pristupa register.html
      if (localStorage.getItem("registeredUser")) {
        console.log("Korisnik je već registriran, može pristupiti register.html");
      }

      form.addEventListener("submit", function (event) {
        event.preventDefault();

        const username = document.getElementById("username").value.trim();
        const email = document.getElementById("email").value.trim();
        const password = document.getElementById("password").value.trim();
        const confirmPassword = document.getElementById("confirm-password").value.trim();
        const postalCode = document.getElementById("postal-code").value.trim();
        const city = document.getElementById("city").value.trim();
        const street = document.getElementById("street").value.trim();
        const houseNumber = document.getElementById("house-number").value.trim();
        const phoneNumber = document.getElementById("phone-number").value.trim();

        // Dohvati postojeće korisnike
        let users = JSON.parse(localStorage.getItem("users")) || [];
        if (users.some(user => user.email === email)) {
          displayMessage("Već ste registrirani s ovim emailom.", "error");
          return;
        }

        if (username.length < 4) {
          displayMessage("Korisničko ime mora imati najmanje 4 znaka.", "error");
          return;
        }

        if (!email.endsWith("@gmail.com")) {
          displayMessage("Email mora sadržavati '@gmail.com'.", "error");
          return;
        }

        if (password.length < 8) {
          displayMessage("Lozinka mora imati najmanje 8 znakova.", "error");
          return;
        }

        if (password !== confirmPassword) {
          displayMessage("Lozinke se ne podudaraju!", "error");
          document.getElementById("confirm-password").value = "";
          return;
        }

        if (!postalCode || !city || !street || !houseNumber || !phoneNumber) {
          displayMessage("Sva polja su obavezna!", "error");
          return;
        }

        // Spremanje novog korisnika
        const user = {
          username,
          email,
          password,
          postalCode,
          city,
          street,
          houseNumber,
          phoneNumber
        };

        // Odjava trenutnog korisnika prije registracije novog
        localStorage.removeItem("loggedInUser");

        users.push(user);
        localStorage.setItem("users", JSON.stringify(users));

        displayMessage("Registracija uspješna!", "success");
        setTimeout(() => {
          window.location.href = "index.html";
        }, 2000);
      });

      function displayMessage(message, type) {
        messageBox.textContent = message;
        messageBox.className = type;
        messageBox.style.display = "block";
      }
    });
  </script>
</head>
<body>
  <header>
    <h1>Registracija</h1>
    <nav>
      <a href="index.html">Početna</a>
      <a href="login.html">Login</a>
    </nav>
  </header>
  <main>
    <form class="registration-form">
      <label for="username">Korisničko ime:</label>
      <input type="text" id="username" name="username" required>

      <label for="email">Email:</label>
      <input type="email" id="email" name="email" required>

      <label for="password">Lozinka:</label>
      <input type="password" id="password" name="password" required>

      <label for="confirm-password">Potvrda lozinke:</label>
      <input type="password" id="confirm-password" name="confirm-password" required>

      <label for="postal-code">Poštanski broj:</label>
      <input type="text" id="postal-code" name="postal-code" required>

      <label for="city">Grad:</label>
      <input type="text" id="city" name="city" required>

      <label for="street">Ulica:</label>
      <input type="text" id="street" name="street" required>

      <label for="house-number">Kućni broj:</label>
      <input type="text" id="house-number" name="house-number" required>

      <label for="phone-number">Broj mobitela:</label>
      <input type="text" id="phone-number" name="phone-number" required>

      <div id="message-box"></div>

      <button type="submit">Registriraj se</button>
    </form>
  </main>
  <footer>
    <p>&copy; 2025 Fast Food.</p>
  </footer>
</body>
</html>







